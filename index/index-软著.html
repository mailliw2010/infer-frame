<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ¨ç†å¼•æ“è½¯ä»¶ - NNDeploy</title>
    
    <!-- åŸæœ‰çš„ React åº”ç”¨èµ„æº -->
    <script defer src="/static/js/lib-axios.3ae5100a.js"></script>
    <script defer src="/static/js/lib-react.e068bcda.js"></script>
    <script defer src="/static/js/lib-router.3b6c3153.js"></script>
    <script defer src="/static/js/904.154b73e2.js"></script>
    <script defer src="/static/js/index.b0c2ddef.js"></script>
    <link href="/static/css/904.2d505b48.css" rel="stylesheet">
    <link href="/static/css/index.86d69fd6.css" rel="stylesheet">
    
    <style>
        /* åŸºç¡€é‡ç½® */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 250px;
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
            position: fixed;
            height: 100%;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 24px 18px;
            background-color: #34495e;
            border-bottom: 1px solid #1a252f;
        }

        .sidebar-header h1 { font-size: 18px; margin: 0 0 6px 0; }
        .sidebar-header p { margin: 0; color: #95a5a6; font-size: 12px; }

        .menu-list { list-style: none; padding: 18px 0; margin: 0; }
        .menu-list li { margin-bottom: 4px; }
        .menu-list a { display: flex; align-items: center; padding: 12px 18px; color: #ecf0f1; text-decoration: none; border-left: 3px solid transparent; transition: all .2s; }
        .menu-list a:hover { background: #34495e; border-left-color: #3498db; }
        .menu-list a.active { background: #3498db; border-left-color: #f39c12; }
        .menu-list a span.icon { width: 26px; display: inline-block; }

        .main-content { margin-left: 250px; min-height: 100vh; }
        .top-bar { background: #fff; padding: 14px 26px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.06); }
        .top-bar h2 { margin: 0; font-size: 20px; color: #2c3e50; }
        .user-info { color: #7f8c8d; }

        .page-content { padding: 20px 26px; }

        .content-card { background: #fff; border-radius: 8px; padding: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.06); margin-bottom: 18px; }
        .content-card h3 { margin: 0 0 12px 0; font-size: 16px; color: #2c3e50; }

        /* æ¨¡å‹ç®¡ç† */
        .model-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
        .model-card { background: #fff; border: 1px solid #e8e8e8; border-radius: 8px; padding: 14px; }
        .model-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
        .model-name { font-weight:600; color:#2c3e50; }
        .model-status { padding:4px 10px; border-radius:12px; font-size:12px; }
        .status-active { background:#d4edda; color:#155724; }
        .status-inactive { background:#f8d7da; color:#721c24; }

        /* æµæ°´çº¿ */
        .pipeline-options { display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:12px; }
        .pipeline-option { background:#fff; border:1px solid #e8e8e8; border-radius:8px; padding:18px; text-align:center; cursor:pointer; }
        .pipeline-option.selected { border-color:#3498db; background:#eaf5ff; }
        .pipeline-icon { font-size:36px; margin-bottom:8px; }

    /* å·¥ä½œæµè§†å›¾ */
    .workflow-summary { display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:14px; }
    .workflow-summary-card { background:#f7f9fc; border:1px solid #e1e6ef; border-radius:10px; padding:18px; box-shadow:0 2px 4px rgba(36,60,120,0.06); }
    .workflow-summary-card .card-title { font-size:13px; color:#617089; text-transform:uppercase; letter-spacing:0.6px; margin-bottom:6px; }
    .workflow-summary-card .card-value { font-size:20px; font-weight:600; color:#2c3e50; margin-bottom:6px; }
    .workflow-summary-card .card-subtitle { font-size:12px; color:#7f8c8d; }
    .workflow-summary-card .card-icon { font-size:24px; margin-bottom:8px; }

    .workflow-diagram { display:flex; gap:16px; align-items:stretch; overflow-x:auto; padding-bottom:10px; }
    .workflow-step { position:relative; flex:0 0 240px; background:#fff; border:1px solid #e1e6ef; border-radius:12px; padding:18px; box-shadow:0 6px 16px rgba(35,70,130,0.06); }
    .workflow-step::after { content:'âœ'; position:absolute; right:-20px; top:50%; transform:translateY(-50%); font-size:20px; color:#c3cbe0; }
    .workflow-step:last-child::after { display:none; }
    .workflow-step h4 { margin:0 0 8px 0; font-size:16px; color:#2c3e50; }
    .workflow-step p { margin:0; font-size:13px; color:#66758c; line-height:1.5; }
    .workflow-icon { font-size:30px; margin-bottom:10px; }
    .workflow-tags { margin-top:14px; display:flex; flex-wrap:wrap; gap:8px; }
    .workflow-tag { background:#eef3fb; color:#356ac3; padding:4px 10px; border-radius:14px; font-size:12px; }

    .workflow-detail-section { margin-bottom:18px; }
    .workflow-detail-section h4 { margin:0 0 10px 0; font-size:15px; color:#2c3e50; }
    .workflow-detail-list { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:10px 18px; font-size:13px; color:#4a566c; }
        .workflow-detail-item { background:#f8faff; border:1px solid #e1e6ef; border-radius:10px; padding:10px 12px; }
        .workflow-detail-item strong { color:#2c3e50; font-weight:600; }

        /* å·¥ä½œæµé…ç½®ç¼–è¾‘ */
        .config-modal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center; }
        .config-modal.show { display:flex; }
        .config-modal-content { background:#fff; border-radius:12px; width:90%; max-width:800px; max-height:85vh; overflow-y:auto; box-shadow:0 10px 40px rgba(0,0,0,0.3); }
        .config-modal-header { padding:20px 24px; border-bottom:1px solid #e8e8e8; display:flex; justify-content:space-between; align-items:center; }
        .config-modal-header h3 { margin:0; font-size:18px; color:#2c3e50; }
        .config-modal-close { background:none; border:none; font-size:24px; color:#7f8c8d; cursor:pointer; padding:0; width:30px; height:30px; }
        .config-modal-close:hover { color:#e74c3c; }
        .config-modal-body { padding:24px; }
        .config-section { margin-bottom:24px; }
        .config-section h4 { margin:0 0 12px 0; font-size:15px; color:#2c3e50; border-left:3px solid #3498db; padding-left:10px; }
        .config-form-group { margin-bottom:16px; }
        .config-form-group label { display:block; margin-bottom:6px; font-size:13px; color:#555; font-weight:500; }
        .config-form-group input, .config-form-group select { width:100%; padding:10px 12px; border:1px solid #ddd; border-radius:6px; font-size:14px; }
        .config-form-group input:focus, .config-form-group select:focus { outline:none; border-color:#3498db; box-shadow:0 0 0 3px rgba(52,152,219,0.1); }
        .config-form-row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
        .config-modal-footer { padding:16px 24px; border-top:1px solid #e8e8e8; display:flex; justify-content:flex-end; gap:12px; }
        .config-btn { padding:10px 20px; border:none; border-radius:6px; font-size:14px; font-weight:500; cursor:pointer; transition:all 0.3s; }
        .config-btn-primary { background:#3498db; color:white; }
        .config-btn-primary:hover { background:#2980b9; }
        .config-btn-secondary { background:#ecf0f1; color:#555; }
        .config-btn-secondary:hover { background:#bdc3c7; }
        .edit-config-btn { background:#3498db; color:white; border:none; padding:8px 16px; border-radius:6px; font-size:13px; cursor:pointer; margin-left:12px; }
        .edit-config-btn:hover { background:#2980b9; }
        .export-config-btn { background:#27ae60; color:white; border:none; padding:8px 16px; border-radius:6px; font-size:13px; cursor:pointer; margin-left:8px; }
        .export-config-btn:hover { background:#229954; }
        .import-config-btn { background:#f39c12; color:white; border:none; padding:8px 16px; border-radius:6px; font-size:13px; cursor:pointer; margin-left:8px; }
        .import-config-btn:hover { background:#d68910; }
        .add-workflow-btn { background:#27ae60; color:white; border:none; padding:8px 16px; border-radius:6px; font-size:13px; cursor:pointer; margin-left:8px; }
        .add-workflow-btn:hover { background:#229954; }

        /* å·¥ä½œæµåˆ—è¡¨ - æ‰‹é£ç´æ ·å¼ */
        .workflow-list { margin-top:20px; }
        .workflow-item { background:#fff; border:1px solid #e1e6ef; border-radius:10px; margin-bottom:12px; overflow:hidden; }
        .workflow-header { display:flex; justify-content:space-between; align-items:center; padding:16px 20px; cursor:pointer; background:#f8faff; transition:background 0.3s; }
        .workflow-header:hover { background:#eef3fb; }
        .workflow-header.active { background:#e3f2fd; border-bottom:1px solid #e1e6ef; }
        .workflow-title-section { display:flex; align-items:center; flex:1; }
        .workflow-expand-icon { font-size:18px; margin-right:12px; transition:transform 0.3s; color:#3498db; }
        .workflow-expand-icon.expanded { transform:rotate(90deg); }
        .workflow-title { font-size:16px; font-weight:600; color:#2c3e50; margin-right:12px; }
        .workflow-status { padding:4px 10px; border-radius:12px; font-size:12px; font-weight:500; }
        .workflow-status.active { background:#d4edda; color:#155724; }
        .workflow-status.inactive { background:#f8d7da; color:#721c24; }
        .workflow-actions { display:flex; gap:8px; }
        .workflow-action-btn { background:none; border:none; padding:6px 12px; border-radius:6px; font-size:13px; cursor:pointer; transition:all 0.3s; }
        .workflow-action-btn:hover { background:#e8e8e8; }
        .workflow-action-btn.edit { color:#3498db; }
        .workflow-action-btn.delete { color:#e74c3c; }
        .workflow-action-btn.activate { color:#27ae60; }
        .workflow-action-btn.deactivate { color:#e67e22; }
        .workflow-body { max-height:0; overflow:hidden; transition:max-height 0.3s ease-out; }
        .workflow-body.expanded { max-height:2000px; transition:max-height 0.5s ease-in; }
        .workflow-content { padding:20px; }
        .workflow-summary-mini { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px; margin-bottom:16px; }
        .workflow-summary-mini-item { background:#f8faff; padding:12px; border-radius:8px; border-left:3px solid #3498db; }
        .workflow-summary-mini-item label { font-size:12px; color:#7f8c8d; display:block; margin-bottom:4px; }
        .workflow-summary-mini-item value { font-size:14px; color:#2c3e50; font-weight:600; display:block; }

        /* ç›‘æ§ */
        .monitor-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 16px; }
        .monitor-card { background:#fff; border-radius:8px; padding:12px; }
        .monitor-header { display:flex; justify-content:space-between; align-items:center; }
        .monitor-title { font-weight:600; }
        .monitor-value { font-weight:700; color:#3498db; }
        .chart-container { width:100%; height:160px; }

        /* æ—¥å¿— */
        .log-container { background:#1e1e1e; color:#d4d4d4; padding:14px; border-radius:8px; font-family:monospace; max-height:560px; overflow:auto; }
        .log-entry { margin-bottom:8px; }
        .log-time { color:#858585; margin-right:8px; }
        .log-level-info { color:#4ec9b0; margin-right:6px; }
        .log-level-warn { color:#dcdcaa; margin-right:6px; }
        .log-level-error { color:#f48771; margin-right:6px; }

        .hidden { display:none; }

        /* ç™»å½•ç•Œé¢æ ·å¼ */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-box {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 40px;
            width: 400px;
            max-width: 90%;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            font-size: 28px;
            color: #2c3e50;
            margin: 0 0 8px 0;
        }

        .login-header p {
            color: #7f8c8d;
            margin: 0;
            font-size: 14px;
        }

        .login-form {
            display: flex;
            flex-direction: column;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 500;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .login-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .login-button:active {
            transform: translateY(0);
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .login-hint {
            margin-top: 20px;
            text-align: center;
            color: #95a5a6;
            font-size: 12px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        #app-container {
            display: none;
        }

        #app-container.show {
            display: block;
        }
    </style>
    
    <!-- åœ¨ CSS åŠ è½½åç«‹å³æ£€æŸ¥ç™»å½•çŠ¶æ€ï¼Œé¿å…é—ªçƒ -->
    <script>
        // é¡µé¢åŠ è½½å‰ç«‹å³æ£€æŸ¥ç™»å½•çŠ¶æ€ï¼Œé¿å…æ˜¾ç¤ºç™»å½•ç•Œé¢é—ªçƒ
        (function() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const currentHash = window.location.hash || '#/';

            if (isLoggedIn === 'true') {
                const style = document.createElement('style');
                style.id = 'login-bypass-style';

                let css = '#login-container { display: none !important; } #app-container { display: block !important; }';

                if (currentHash === '#/workflow') {
                    css += ' #page-dashboard { display: none !important; } #page-workflow { display: block !important; }';
                } else if (currentHash === '#/models') {
                    css += ' #page-dashboard { display: none !important; } #page-models { display: block !important; }';
                } else if (currentHash === '#/pipeline') {
                    css += ' #page-dashboard { display: none !important; } #page-pipeline { display: block !important; }';
                } else if (currentHash === '#/monitor') {
                    css += ' #page-dashboard { display: none !important; } #page-monitor { display: block !important; }';
                } else if (currentHash === '#/logs') {
                    css += ' #page-dashboard { display: none !important; } #page-logs { display: block !important; }';
                }

                style.textContent = css;
                document.head.appendChild(style);
            }
        })();
    </script>
</head>
<body>
    <!-- ç™»å½•ç•Œé¢ -->
    <div id="login-container" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1>ğŸ¤– AIæ¨ç†å¼•æ“è½¯ä»¶ V1.0</h1>
            </div>
            <div class="error-message" id="error-message">ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯</div>
            <form class="login-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="username">ç”¨æˆ·å</label>
                    <input type="text" id="username" name="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">å¯†ç </label>
                    <input type="password" id="password" name="password" placeholder="è¯·è¾“å…¥å¯†ç " required autocomplete="current-password">
                </div>
                <button type="submit" class="login-button">ç™»å½•</button>
            </form>
            <div class="login-hint">
                ğŸ’¡ æç¤ºï¼šé»˜è®¤è´¦å·å¯†ç å‡ä¸º <strong>admin</strong>
            </div>
        </div>
    </div>

    <!-- ä¸»åº”ç”¨ç•Œé¢ -->
    <div id="app-container">
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>AIæ¨ç†å¼•æ“è½¯ä»¶ V1.0</h1>
        </div>
        <ul class="menu-list">
            <li><a href="#/" class="menu-link" data-page="dashboard" data-title="æ§åˆ¶å°æ¦‚è§ˆ"><span class="icon">ğŸ’»</span>æ§åˆ¶å°æ¦‚è§ˆ</a></li>
            <li><a href="#/workflow" class="menu-link" data-page="workflow" data-title="å·¥ä½œæµé…ç½®"><span class="icon">âš™ï¸</span>å·¥ä½œæµé…ç½®</a></li>
            <li><a href="#/pipeline" class="menu-link" data-page="pipeline" data-title="æµæ°´çº¿ç®¡ç†"><span class="icon">ğŸ”„</span>æµæ°´çº¿ç®¡ç†</a></li>
            <li><a href="#/models" class="menu-link" data-page="models" data-title="æ¨¡å‹ç®¡ç†"><span class="icon">ğŸ§ </span>æ¨¡å‹ç®¡ç†</a></li>
            <li><a href="#/monitor" class="menu-link" data-page="monitor" data-title="å®æ—¶ç›‘æ§"><span class="icon">âš¡</span>å®æ—¶ç›‘æ§</a></li>
            <li><a href="#/logs" class="menu-link" data-page="logs" data-title="ç³»ç»Ÿæ—¥å¿—"><span class="icon">ğŸ“œ</span>ç³»ç»Ÿæ—¥å¿—</a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="top-bar">
            <h2 id="page-title">æ§åˆ¶å°æ¦‚è§ˆ</h2>
            <div class="user-info">
                å½“å‰ç”¨æˆ·: Admin &nbsp;|&nbsp; 
                <a href="javascript:void(0)" onclick="handleLogout()" style="color:#3498db; text-decoration:none; cursor:pointer;">é€€å‡ºç™»å½•</a>
            </div>
        </div>

        <div class="page-content">
            <!-- Dashboard: æ§åˆ¶å°æ¦‚è§ˆ -->
            <div id="page-dashboard" class="page-container">
                <!-- React åº”ç”¨å®¹å™¨ï¼ˆç”¨äº /design ç­‰è·¯ç”±ï¼‰ -->
                <div id="react-app-container">
                    <div id="root"></div>
                </div>
                
                <!-- è‡ªå®šä¹‰æ¦‚è§ˆå†…å®¹ï¼ˆä»…åœ¨æ ¹è·¯å¾„æ˜¾ç¤ºï¼‰ -->
                <div id="custom-dashboard">
                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap:16px; margin-bottom:20px;">
                    <div class="content-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white;">
                        <div style="font-size:14px; opacity:0.9;">è¿è¡Œä¸­çš„æ¨¡å‹</div>
                        <div style="font-size:32px; font-weight:700; margin:8px 0;">5</div>
                        <div style="font-size:12px; opacity:0.8;">+ 2 ä¸ªå¾…éƒ¨ç½²</div>
                    </div>
                    <div class="content-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color:white;">
                        <div style="font-size:14px; opacity:0.9;">æ¨ç†ä»»åŠ¡æ•°</div>
                        <div style="font-size:32px; font-weight:700; margin:8px 0;">1,247</div>
                        <div style="font-size:12px; opacity:0.8;">ä»Šæ—¥æ‰§è¡Œ</div>
                    </div>
                    <div class="content-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color:white;">
                        <div style="font-size:14px; opacity:0.9;">å¹³å‡æ¨ç†æ—¶é—´</div>
                        <div style="font-size:32px; font-weight:700; margin:8px 0;">12.3<span style="font-size:18px;">ms</span></div>
                        <div style="font-size:12px; opacity:0.8;">â†“ 8% vs æ˜¨æ—¥</div>
                    </div>
                    <div class="content-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color:white;">
                        <div style="font-size:14px; opacity:0.9;">ç³»ç»Ÿååé‡</div>
                        <div style="font-size:32px; font-weight:700; margin:8px 0;">82<span style="font-size:18px;">fps</span></div>
                        <div style="font-size:12px; opacity:0.8;">å®æ—¶æ€§èƒ½</div>
                    </div>
                </div>

                <!-- å¿«é€Ÿæ“ä½œ -->
                <div class="content-card">
                    <h3>âš¡ å¿«é€Ÿæ“ä½œ</h3>
                    <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap:12px; margin-top:12px;">
                        <button onclick="window.location.hash='#/workflow'" style="background:#3498db; color:white; border:none; padding:14px; border-radius:6px; cursor:pointer; font-size:14px; font-weight:500;">
                            âš™ï¸ åˆ›å»ºå·¥ä½œæµ
                        </button>
                        <button onclick="window.location.hash='#/models'" style="background:#2ecc71; color:white; border:none; padding:14px; border-radius:6px; cursor:pointer; font-size:14px; font-weight:500;">
                            ğŸ§  ç®¡ç†æ¨¡å‹
                        </button>
                        <button onclick="window.location.hash='#/pipeline'" style="background:#e74c3c; color:white; border:none; padding:14px; border-radius:6px; cursor:pointer; font-size:14px; font-weight:500;">
                            ğŸ”„ é…ç½®æµæ°´çº¿
                        </button>
                        <button onclick="window.location.hash='#/monitor'" style="background:#f39c12; color:white; border:none; padding:14px; border-radius:6px; cursor:pointer; font-size:14px; font-weight:500;">
                            âš¡ æŸ¥çœ‹ç›‘æ§
                        </button>
                    </div>
                </div>

                <!-- ç³»ç»ŸçŠ¶æ€ -->
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px;">
                    <div class="content-card">
                        <h3>ğŸ“Š èµ„æºä½¿ç”¨æƒ…å†µ</h3>
                        <div style="margin-top:12px;">
                            <div style="margin-bottom:16px;">
                                <div style="display:flex; justify-content:space-between; margin-bottom:6px;">
                                    <span style="font-size:13px; color:#555;">CPU</span>
                                    <span style="font-size:13px; font-weight:600; color:#3498db;">45%</span>
                                </div>
                                <div style="background:#e8e8e8; height:8px; border-radius:4px; overflow:hidden;">
                                    <div style="background:#3498db; height:100%; width:45%;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom:16px;">
                                <div style="display:flex; justify-content:space-between; margin-bottom:6px;">
                                    <span style="font-size:13px; color:#555;">NPU</span>
                                    <span style="font-size:13px; font-weight:600; color:#9b59b6;">68%</span>
                                </div>
                                <div style="background:#e8e8e8; height:8px; border-radius:4px; overflow:hidden;">
                                    <div style="background:#9b59b6; height:100%; width:68%;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom:16px;">
                                <div style="display:flex; justify-content:space-between; margin-bottom:6px;">
                                    <span style="font-size:13px; color:#555;">å†…å­˜</span>
                                    <span style="font-size:13px; font-weight:600; color:#2ecc71;">6.2 / 16 GB</span>
                                </div>
                                <div style="background:#e8e8e8; height:8px; border-radius:4px; overflow:hidden;">
                                    <div style="background:#2ecc71; height:100%; width:39%;"></div>
                                </div>
                            </div>
                            <div>
                                <div style="display:flex; justify-content:space-between; margin-bottom:6px;">
                                    <span style="font-size:13px; color:#555;">æ˜¾å­˜</span>
                                    <span style="font-size:13px; font-weight:600; color:#e67e22;">2.8 / 8 GB</span>
                                </div>
                                <div style="background:#e8e8e8; height:8px; border-radius:4px; overflow:hidden;">
                                    <div style="background:#e67e22; height:100%; width:35%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-card">
                        <h3>ğŸ”¥ çƒ­é—¨æ¨¡å‹</h3>
                        <div style="margin-top:12px;">
                            <div style="display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #f0f0f0;">
                                <div>
                                    <div style="font-weight:600; font-size:14px;">YOLOv8s</div>
                                    <div style="color:#7f8c8d; font-size:12px;">ç›®æ ‡æ£€æµ‹</div>
                                </div>
                                <div style="text-align:right;">
                                    <div style="color:#2ecc71; font-weight:600;">892æ¬¡</div>
                                    <div style="color:#7f8c8d; font-size:12px;">ä»Šæ—¥è°ƒç”¨</div>
                                </div>
                            </div>
                            <div style="display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #f0f0f0;">
                                <div>
                                    <div style="font-weight:600; font-size:14px;">RetinaFace</div>
                                    <div style="color:#7f8c8d; font-size:12px;">äººè„¸æ£€æµ‹</div>
                                </div>
                                <div style="text-align:right;">
                                    <div style="color:#3498db; font-weight:600;">267æ¬¡</div>
                                    <div style="color:#7f8c8d; font-size:12px;">ä»Šæ—¥è°ƒç”¨</div>
                                </div>
                            </div>
                            <div style="display:flex; justify-content:space-between; padding:10px 0;">
                                <div>
                                    <div style="font-weight:600; font-size:14px;">YOLOv5s</div>
                                    <div style="color:#7f8c8d; font-size:12px;">ç›®æ ‡æ£€æµ‹</div>
                                </div>
                                <div style="text-align:right;">
                                    <div style="color:#9b59b6; font-weight:600;">88æ¬¡</div>
                                    <div style="color:#7f8c8d; font-size:12px;">ä»Šæ—¥è°ƒç”¨</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div><!-- å…³é—­ custom-dashboard -->
            </div><!-- å…³é—­ page-dashboard -->

            <!-- Workflow é¡µé¢ -->
            <div id="page-workflow" class="page-container hidden">
                <div class="content-card">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                        <h3 style="margin:0;">ğŸ” å·¥ä½œæµé…ç½®åˆ—è¡¨</h3>
                        <div>
                            <button class="add-workflow-btn" onclick="addNewWorkflow()">â• æ–°å»ºå·¥ä½œæµ</button>
                            <button class="export-config-btn" onclick="activateAllWorkflows()">âœ… å…¨éƒ¨æ¿€æ´»</button>
                            <button class="export-config-btn" onclick="deactivateAllWorkflows()">â¸ï¸ å…¨éƒ¨å–æ¶ˆ</button>
                            <button class="export-config-btn" onclick="exportAllWorkflows()">ğŸ“¤ å¯¼å‡ºå…¨éƒ¨</button>
                            <button class="import-config-btn" onclick="document.getElementById('importWorkflowsFile').click()">ğŸ“¥ å¯¼å…¥</button>
                            <input type="file" id="importWorkflowsFile" accept=".json" style="display:none;" onchange="importConfig(event)">
                        </div>
                    </div>
                    <p style="color:#7f8c8d; margin-bottom:12px;">ç®¡ç†å¤šä¸ªæ¨ç†å·¥ä½œæµï¼Œæ”¯æŒåŒæ—¶æ¿€æ´»å¤šä¸ªå·¥ä½œæµã€‚ç‚¹å‡»"âœ… æ¿€æ´»"æˆ–"â¸ï¸ å–æ¶ˆæ¿€æ´»"æŒ‰é’®åˆ‡æ¢çŠ¶æ€ã€‚</p>
                    <div id="workflowList" class="workflow-list"></div>
                </div>
            </div>

            <!-- Models é¡µé¢ -->
            <div id="page-models" class="page-container hidden">
                <div class="content-card">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                        <h3 style="margin:0;">ğŸ§  æ¨¡å‹ç®¡ç†</h3>
                        <div>
                            <button class="add-workflow-btn" onclick="addNewModel()">â• æ–°å¢æ¨¡å‹</button>
                            <button class="export-config-btn" onclick="refreshModels()">ğŸ”„ åˆ·æ–°åˆ—è¡¨</button>
                        </div>
                    </div>
                    <p style="color:#7f8c8d; margin-bottom:10px;">ç®¡ç†å’Œé…ç½®å¹³å°ä¸Šçš„AIæ¨ç†æ¨¡å‹</p>
                    <div class="model-grid" id="modelGrid"></div>
                </div>
            </div>

            <!-- Pipeline é¡µé¢ -->
            <div id="page-pipeline" class="page-container hidden">
                <div class="content-card">
                    <h3>ğŸ”„ æµæ°´çº¿å¹¶è¡Œé…ç½®</h3>
                    <p style="color:#7f8c8d; margin-bottom:10px;">é€‰æ‹©å¹¶è¡Œæ¨¡å¼ä»¥ä¼˜åŒ–ååä¸å»¶è¿Ÿ</p>
                    <div class="pipeline-options" id="pipelineOptions"></div>
                </div>
            </div>

            <!-- Monitor é¡µé¢ -->
            <div id="page-monitor" class="page-container hidden">
                <div class="monitor-grid" id="monitorGrid"></div>
            </div>

            <!-- Logs é¡µé¢ -->
            <div id="page-logs" class="page-container hidden">
                <div class="content-card">
                    <h3>ğŸ“œ ç³»ç»Ÿæ—¥å¿—</h3>
                    <div class="log-container" id="logContainer"></div>
                    </div>
            </div>
        </div>
    </div>
    </div> <!-- å…³é—­ app-container -->

    <!-- å·¥ä½œæµé…ç½®ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="configModal" class="config-modal">
        <div class="config-modal-content">
            <div class="config-modal-header">
                <h3>âš™ï¸ ç¼–è¾‘å·¥ä½œæµé…ç½®</h3>
                <button class="config-modal-close" onclick="closeConfigModal()">&times;</button>
            </div>
            <div class="config-modal-body">
                <!-- å·¥ä½œæµä¿¡æ¯ -->
                <div class="config-section">
                    <h4>å·¥ä½œæµä¿¡æ¯</h4>
                    <div class="config-form-group">
                        <label>å·¥ä½œæµåç§°</label>
                        <input type="text" id="config-workflow-name" placeholder="ä¾‹å¦‚: é»˜è®¤æ£€æµ‹å·¥ä½œæµ">
                    </div>
                </div>
                
                <!-- å¹³å°é…ç½® -->
                <div class="config-section">
                    <h4>å¹³å°é…ç½®</h4>
                    <div class="config-form-group">
                        <label>å½“å‰å¹³å°</label>
                        <select id="config-platform">
                            <option value="ascend">Ascend (æ˜‡è…¾)</option>
                            <option value="sophon">Sophon (ç®—èƒ½)</option>
                            <option value="jetson">Jetson (è‹±ä¼Ÿè¾¾)</option>
                            <option value="cpu">CPU</option>
                        </select>
                    </div>
                </div>

                <!-- ç®—æ³•å‚æ•° -->
                <div class="config-section">
                    <h4>ç®—æ³•å‚æ•°</h4>
                    <div class="config-form-group">
                        <label>æ¨¡å‹åç§°</label>
                        <input type="text" id="config-modelName" placeholder="ä¾‹å¦‚: yolov8s_quant_310b.om">
                    </div>
                    <div class="config-form-row">
                        <div class="config-form-group">
                            <label>ç½®ä¿¡åº¦é˜ˆå€¼ (0-1)</label>
                            <input type="number" id="config-confidence" step="0.01" min="0" max="1">
                        </div>
                        <div class="config-form-group">
                            <label>NMS é˜ˆå€¼ (0-1)</label>
                            <input type="number" id="config-nms" step="0.01" min="0" max="1">
                        </div>
                    </div>
                    <div class="config-form-row">
                        <div class="config-form-group">
                            <label>å¤šæ ‡ç­¾æ£€æµ‹</label>
                            <select id="config-multiLabel">
                                <option value="false">å…³é—­</option>
                                <option value="true">å¼€å¯</option>
                            </select>
                        </div>
                        <div class="config-form-group">
                            <label>OSD æ¸²æŸ“</label>
                            <select id="config-osd">
                                <option value="false">å…³é—­</option>
                                <option value="true">å¼€å¯</option>
                            </select>
                        </div>
                    </div>
                    <div class="config-form-group">
                        <label>æ ‡ç­¾æ˜ å°„ (æ ¼å¼: 0:äºº,56:æ¡Œå­)</label>
                        <input type="text" id="config-labelMap" placeholder="ä¾‹å¦‚: 0:äºº,56:æ¡Œå­">
                    </div>
                </div>

                <!-- åº”ç”¨é…ç½® -->
                <div class="config-section">
                    <h4>åº”ç”¨é…ç½®</h4>
                    <div class="config-form-group">
                        <label>æ¨¡å‹ç›®å½•</label>
                        <input type="text" id="config-modelDir" placeholder="ä¾‹å¦‚: demo/data/model">
                    </div>
                    <div class="config-form-row">
                        <div class="config-form-group">
                            <label>è¾“å…¥ç±»å‹</label>
                            <select id="config-inputType">
                                <option value="directory">ç›®å½•</option>
                                <option value="rtsp stream">RTSP æµ</option>
                                <option value="mp4 file">MP4 æ–‡ä»¶</option>
                            </select>
                        </div>
                        <div class="config-form-group">
                            <label>æ— é™å¾ªç¯</label>
                            <select id="config-infinite">
                                <option value="false">å¦</option>
                                <option value="true">æ˜¯</option>
                            </select>
                        </div>
                    </div>
                    <div class="config-form-group">
                        <label>è¾“å…¥è·¯å¾„</label>
                        <input type="text" id="config-input" placeholder="ä¾‹å¦‚: demo/data/image">
                    </div>
                    <div class="config-form-group">
                        <label>è¾“å‡ºè·¯å¾„</label>
                        <input type="text" id="config-output" placeholder="ä¾‹å¦‚: demo/out">
                    </div>
                    <div class="config-form-row">
                        <div class="config-form-group">
                            <label>æ¨ç†é¢‘ç‡ (fps)</label>
                            <input type="number" id="config-inferFrequency" min="1" max="120">
                        </div>
                        <div class="config-form-group">
                            <label>åº”ç”¨ç±»å‹</label>
                            <select id="config-appType">
                                <option value="DETECTION">DETECTION</option>
                                <option value="DETECTION_PROPERTY">DETECTION_PROPERTY</option>
                                <option value="SEGMENT">SEGMENT</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="config-modal-footer">
                <button class="config-btn config-btn-secondary" onclick="resetConfigToDefault()">é‡ç½®é»˜è®¤</button>
                <div style="flex:1;"></div>
                <button class="config-btn config-btn-secondary" onclick="closeConfigModal()">å–æ¶ˆ</button>
                <button class="config-btn config-btn-primary" onclick="saveConfig()">ä¿å­˜é…ç½®</button>
            </div>
        </div>
    </div>

    <!-- åŸæœ‰ React èµ„æº -->
    <script src="/static/js/lib-axios.3ae5100a.js"></script>
    <script src="/static/js/lib-react.e068bcda.js"></script>
    <script src="/static/js/lib-router.3b6c3153.js"></script>
    <script src="/static/js/904.154b73e2.js"></script>
    <script src="/static/js/index.b0c2ddef.js"></script>

    <script>
        // ========== ç™»å½•é€»è¾‘ ==========
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('error-message');

            // éªŒè¯è´¦å·å¯†ç 
            if (username === 'admin' && password === 'admin') {
                // ç™»å½•æˆåŠŸï¼Œä¿å­˜ç™»å½•çŠ¶æ€
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('username', username);
                
                // éšè—ç™»å½•ç•Œé¢ï¼Œæ˜¾ç¤ºä¸»åº”ç”¨
                document.getElementById('login-container').style.display = 'none';
                document.getElementById('app-container').classList.add('show');
                
                // åˆå§‹åŒ–åº”ç”¨
                initApp();
            } else {
                // ç™»å½•å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                errorMsg.classList.add('show');
                setTimeout(() => {
                    errorMsg.classList.remove('show');
                }, 3000);
            }
        }

        // é€€å‡ºç™»å½•
        function handleLogout() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('username');
            location.reload();
        }

        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                document.getElementById('login-container').style.display = 'none';
                document.getElementById('app-container').classList.add('show');
                initApp();
            }
        }

        // ========== åº”ç”¨é€»è¾‘ ==========
        // å·¥ä½œæµé…ç½®åˆ—è¡¨ï¼ˆæ”¯æŒå¤šä¸ªå·¥ä½œæµï¼‰
        let workflows = [];
        let currentWorkflowId = null; // å½“å‰æ­£åœ¨ç¼–è¾‘çš„å·¥ä½œæµID
        let activeWorkflowId = null; // å½“å‰æ¿€æ´»çš„å·¥ä½œæµID

        // é»˜è®¤å·¥ä½œæµæ¨¡æ¿
        const defaultWorkflowTemplate = {
            platform: {
                current: 'ascend',
                supported: ['ascend', 'sophon', 'jetson', 'cpu']
            },
            algo: {
                modelName: 'yolov8s_quant_310b.om',
                confidence: 0.6,
                nms: 0.3,
                multiLabel: false,
                osd: true,
                labelMap: { '0': 'äºº', '56': 'æ¡Œå­' }
            },
            app: {
                platform: 'ascend',
                modelDir: 'demo/data/model',
                inputType: 'directory',
                input: 'demo/data/image',
                infinite: true,
                out: 'demo/out',
                inferFrequency: 25,
                type: 'DETECTION_PROPERTY',
                osd: true,
                service: { websocket: { port: null } },
                fence: null
            }
        };

        // ä» localStorage åŠ è½½å·¥ä½œæµåˆ—è¡¨
        function loadWorkflows() {
            const savedWorkflows = localStorage.getItem('workflows');
            if (savedWorkflows) {
                try {
                    workflows = JSON.parse(savedWorkflows);
                    // ç¡®ä¿æ¯ä¸ªå·¥ä½œæµéƒ½æœ‰ id å’Œ name
                    workflows.forEach((wf, index) => {
                        if (!wf.id) wf.id = 'wf_' + Date.now() + '_' + index;
                        if (!wf.name) wf.name = 'å·¥ä½œæµ ' + (index + 1);
                        if (wf.active === undefined) wf.active = index === 0;
                    });
                    // æ‰¾åˆ°æ¿€æ´»çš„å·¥ä½œæµ
                    const active = workflows.find(wf => wf.active);
                    if (active) activeWorkflowId = active.id;
                } catch (e) {
                    console.error('Failed to load workflows:', e);
                    initDefaultWorkflows();
                }
            } else {
                initDefaultWorkflows();
            }
        }

        // åˆå§‹åŒ–é»˜è®¤å·¥ä½œæµ
        function initDefaultWorkflows() {
            workflows = [
                {
                    id: 'wf_' + Date.now() + '_1',
                    name: 'é»˜è®¤æ£€æµ‹å·¥ä½œæµ',
                    active: true,
                    config: JSON.parse(JSON.stringify(defaultWorkflowTemplate))
                }
            ];
            activeWorkflowId = workflows[0].id;
            saveWorkflows();
        }

        // ä¿å­˜å·¥ä½œæµåˆ—è¡¨åˆ° localStorage
        function saveWorkflows() {
            try {
                localStorage.setItem('workflows', JSON.stringify(workflows));
            } catch (e) {
                console.error('Failed to save workflows:', e);
            }
        }

        const inputTypeDictionary = {
            directory: 'ç›®å½•',
            'rtsp stream': 'RTSP æµ',
            'mp4 file': 'MP4 æ–‡ä»¶'
        };

        function buildWorkflowSteps(platformDisplay) {
            const workflowConfig = getActiveWorkflow()?.config || defaultWorkflowTemplate;
            const inputTypeLabel = inputTypeDictionary[workflowConfig.app.inputType] || workflowConfig.app.inputType;
            const labels = Object.values(workflowConfig.algo.labelMap).join(' / ');

            return [
                {
                    icon: 'ğŸ“¥',
                    title: 'æ•°æ®è¾“å…¥',
                    description: `ä» ${workflowConfig.app.input} ç›®å½•è·å–å›¾ç‰‡æˆ–æµå¼æ•°æ®ï¼Œæ”¯æŒæ— é™å¾ªç¯è¯»å–ã€‚`,
                    tags: [`è¾“å…¥ç±»å‹: ${inputTypeLabel}`, `å¾ªç¯è¯»å–: ${workflowConfig.app.infinite ? 'æ˜¯' : 'å¦'}`, `å¹³å°: ${platformDisplay}`]
                },
                {
                    icon: 'ğŸ§¹',
                    title: 'é¢„å¤„ç†',
                    description: 'æŒ‰ç…§ç®—æ³•é¢„è®¾æ‰§è¡Œç¼©æ”¾ã€è‰²å½©åŠå½’ä¸€åŒ–ç­‰é¢„å¤„ç†ï¼Œä¿éšœæ¨¡å‹è¾“å…¥ä¸€è‡´æ€§ã€‚',
                    tags: [`æ¨¡å‹ç›®å½•: ${workflowConfig.app.modelDir}`, `å¤šæ ‡ç­¾: ${workflowConfig.algo.multiLabel ? 'å¼€å¯' : 'å…³é—­'}`]
                },
                {
                    icon: 'ğŸ§ ',
                    title: 'æ¨¡å‹æ¨ç†',
                    description: `åŠ è½½ ${workflowConfig.algo.modelName} æ¨¡å‹ï¼Œæ‰§è¡Œ ${workflowConfig.app.type} æ¨ç†ä»»åŠ¡ã€‚`,
                    tags: [`ç½®ä¿¡åº¦: ${workflowConfig.algo.confidence}`, `NMS: ${workflowConfig.algo.nms}`, `æ¨ç†é¢‘ç‡: ${workflowConfig.app.inferFrequency}fps`]
                },
                {
                    icon: 'ğŸ¨',
                    title: 'ç»“æœæ¸²æŸ“',
                    description: 'æ ¹æ®æ ‡ç­¾æ˜ å°„ç»˜åˆ¶æ£€æµ‹æ¡†åŠå±æ€§ä¿¡æ¯ï¼Œè¾“å‡ºå¯è§†åŒ–ç»“æœã€‚',
                    tags: [`OSD: ${workflowConfig.algo.osd ? 'å¼€å¯' : 'å…³é—­'}`, `æ ‡ç­¾: ${labels}`]
                },
                {
                    icon: 'ğŸ“¤',
                    title: 'ç»“æœè¾“å‡º',
                    description: `å°†æ¨ç†ç»“æœè¾“å‡ºè‡³ ${workflowConfig.app.out}ï¼Œå¯æŒ‰éœ€æ‰©å±•è‡³å®æ—¶æµã€‚`,
                    tags: [`è¾“å‡ºè·¯å¾„: ${workflowConfig.app.out}`, 'æ‰©å±•èƒ½åŠ›: æ–‡ä»¶ / æµåª’ä½“']
                }
            ];
        }

        // è·å–æ¿€æ´»çš„å·¥ä½œæµ
        function getActiveWorkflow() {
            return workflows.find(wf => wf.id === activeWorkflowId);
        }

        // è·å–å·¥ä½œæµé…ç½®
        function getWorkflowById(id) {
            return workflows.find(wf => wf.id === id);
        }

        // æ¸²æŸ“å·¥ä½œæµåˆ—è¡¨
        function renderWorkflowList() {
            const listEl = document.getElementById('workflowList');
            if (!listEl) return;

            if (workflows.length === 0) {
                listEl.innerHTML = '<p style="text-align:center; color:#7f8c8d; padding:40px;">æš‚æ— å·¥ä½œæµï¼Œç‚¹å‡»"æ–°å»ºå·¥ä½œæµ"å¼€å§‹é…ç½®ã€‚</p>';
                return;
            }

            listEl.innerHTML = workflows.map(workflow => {
                const config = workflow.config;
                const isActive = workflow.active;  // ä½¿ç”¨ workflow.active è€Œä¸æ˜¯æ¯”è¾ƒ activeWorkflowId
                
                return `
                    <div class="workflow-item" data-id="${workflow.id}">
                        <div class="workflow-header" onclick="toggleWorkflow('${workflow.id}')">
                            <div class="workflow-title-section">
                                <span class="workflow-expand-icon" id="expand-icon-${workflow.id}">â–¶</span>
                                <span class="workflow-title">${workflow.name}</span>
                                <span class="workflow-status ${isActive ? 'active' : 'inactive'}">
                                    ${isActive ? 'âœ… å·²æ¿€æ´»' : 'â¸ï¸ æœªæ¿€æ´»'}
                                </span>
                            </div>
                            <div class="workflow-actions" onclick="event.stopPropagation()">
                                <button class="workflow-action-btn ${isActive ? 'deactivate' : 'activate'}" 
                                        onclick="activateWorkflow('${workflow.id}')" 
                                        title="${isActive ? 'å–æ¶ˆæ¿€æ´»' : 'æ¿€æ´»æ­¤å·¥ä½œæµ'}">
                                    ${isActive ? 'â¸ï¸ å–æ¶ˆæ¿€æ´»' : 'âœ… æ¿€æ´»'}
                                </button>
                                <button class="workflow-action-btn edit" onclick="openConfigModal('${workflow.id}')" title="ç¼–è¾‘é…ç½®">âœï¸ ç¼–è¾‘</button>
                                <button class="workflow-action-btn delete" onclick="deleteWorkflow('${workflow.id}')" title="åˆ é™¤å·¥ä½œæµ">ğŸ—‘ï¸ åˆ é™¤</button>
                            </div>
                        </div>
                        <div class="workflow-body" id="workflow-body-${workflow.id}">
                            <div class="workflow-content">
                                <!-- æ‘˜è¦ä¿¡æ¯ -->
                                <div class="workflow-summary-mini">
                                    <div class="workflow-summary-mini-item">
                                        <label>å¹³å°</label>
                                        <value>${config.platform.current.toUpperCase()}</value>
                                    </div>
                                    <div class="workflow-summary-mini-item">
                                        <label>æ¨¡å‹</label>
                                        <value>${config.algo.modelName}</value>
                                    </div>
                                    <div class="workflow-summary-mini-item">
                                        <label>ç½®ä¿¡åº¦/NMS</label>
                                        <value>${config.algo.confidence} / ${config.algo.nms}</value>
                                    </div>
                                    <div class="workflow-summary-mini-item">
                                        <label>æ¨ç†é¢‘ç‡</label>
                                        <value>${config.app.inferFrequency} fps</value>
                                    </div>
                                    <div class="workflow-summary-mini-item">
                                        <label>è¾“å…¥</label>
                                        <value>${config.app.input}</value>
                                    </div>
                                    <div class="workflow-summary-mini-item">
                                        <label>è¾“å‡º</label>
                                        <value>${config.app.out}</value>
                                    </div>
                                </div>
                                
                                <!-- æ¨ç†æµç¨‹å›¾ -->
                                <h4 style="margin:16px 0 12px 0; font-size:14px; color:#2c3e50;">æ¨ç†æµç¨‹</h4>
                                <div class="workflow-diagram">
                                    ${buildWorkflowStepsHTML(config)}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // æ„å»ºæ¨ç†æµç¨‹ HTML
        function buildWorkflowStepsHTML(config) {
            const platformDisplay = config.platform.current.charAt(0).toUpperCase() + config.platform.current.slice(1);
            const inputTypeLabel = inputTypeDictionary[config.app.inputType] || config.app.inputType;
            const labels = Object.values(config.algo.labelMap).join(' / ');

            const steps = [
                {
                    icon: 'ğŸ“¥',
                    title: 'æ•°æ®è¾“å…¥',
                    description: `ä» ${config.app.input} è·å–æ•°æ®`,
                    tags: [`${inputTypeLabel}`, `å¹³å°: ${platformDisplay}`]
                },
                {
                    icon: 'ğŸ§¹',
                    title: 'é¢„å¤„ç†',
                    description: 'å›¾åƒé¢„å¤„ç†ä¸å½’ä¸€åŒ–',
                    tags: [`æ¨¡å‹ç›®å½•: ${config.app.modelDir}`]
                },
                {
                    icon: 'ğŸ§ ',
                    title: 'æ¨¡å‹æ¨ç†',
                    description: `${config.algo.modelName}`,
                    tags: [`ç½®ä¿¡åº¦: ${config.algo.confidence}`, `NMS: ${config.algo.nms}`]
                },
                {
                    icon: 'ğŸ¨',
                    title: 'ç»“æœæ¸²æŸ“',
                    description: 'ç»˜åˆ¶æ£€æµ‹æ¡†ä¸æ ‡ç­¾',
                    tags: [`OSD: ${config.algo.osd ? 'å¼€' : 'å…³'}`, `æ ‡ç­¾: ${labels}`]
                },
                {
                    icon: 'ğŸ“¤',
                    title: 'ç»“æœè¾“å‡º',
                    description: `è¾“å‡ºè‡³ ${config.app.out}`,
                    tags: [`${config.app.inferFrequency} fps`]
                }
            ];

            return steps.map(step => `
                <div class="workflow-step">
                    <div class="workflow-icon">${step.icon}</div>
                    <h4>${step.title}</h4>
                    <p>${step.description}</p>
                    <div class="workflow-tags">
                        ${step.tags.map(tag => `<span class="workflow-tag">${tag}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        // å±•å¼€/æŠ˜å å·¥ä½œæµ
        function toggleWorkflow(id) {
            const body = document.getElementById(`workflow-body-${id}`);
            const icon = document.getElementById(`expand-icon-${id}`);
            const header = body.previousElementSibling;
            
            if (body.classList.contains('expanded')) {
                body.classList.remove('expanded');
                icon.classList.remove('expanded');
                header.classList.remove('active');
            } else {
                // æŠ˜å æ‰€æœ‰å…¶ä»–å·¥ä½œæµ
                document.querySelectorAll('.workflow-body').forEach(el => {
                    el.classList.remove('expanded');
                });
                document.querySelectorAll('.workflow-expand-icon').forEach(el => {
                    el.classList.remove('expanded');
                });
                document.querySelectorAll('.workflow-header').forEach(el => {
                    el.classList.remove('active');
                });
                
                // å±•å¼€å½“å‰å·¥ä½œæµ
                body.classList.add('expanded');
                icon.classList.add('expanded');
                header.classList.add('active');
            }
        }

        // æ–°å»ºå·¥ä½œæµ
        function addNewWorkflow() {
            const newId = 'wf_' + Date.now();
            const newWorkflow = {
                id: newId,
                name: `å·¥ä½œæµ ${workflows.length + 1}`,
                active: false,
                config: JSON.parse(JSON.stringify(defaultWorkflowTemplate))
            };
            
            workflows.push(newWorkflow);
            saveWorkflows();
            renderWorkflowList();
            
            // è‡ªåŠ¨å±•å¼€æ–°å»ºçš„å·¥ä½œæµ
            setTimeout(() => toggleWorkflow(newId), 100);
        }

        // æ¿€æ´»/å–æ¶ˆæ¿€æ´»å·¥ä½œæµï¼ˆæ”¯æŒå¤šä¸ªåŒæ—¶æ¿€æ´»ï¼‰
        function activateWorkflow(id) {
            const workflow = getWorkflowById(id);
            if (!workflow) return;
            
            // åˆ‡æ¢æ¿€æ´»çŠ¶æ€
            workflow.active = !workflow.active;
            
            // æ›´æ–° activeWorkflowIdï¼ˆä¿æŒç¬¬ä¸€ä¸ªæ¿€æ´»çš„å·¥ä½œæµIDï¼Œç”¨äºå…¼å®¹ï¼‰
            const firstActive = workflows.find(wf => wf.active);
            activeWorkflowId = firstActive ? firstActive.id : null;
            
            saveWorkflows();
            renderWorkflowList();
        }

        // å…¨éƒ¨æ¿€æ´»
        function activateAllWorkflows() {
            workflows.forEach(wf => wf.active = true);
            const firstActive = workflows.find(wf => wf.active);
            activeWorkflowId = firstActive ? firstActive.id : null;
            saveWorkflows();
            renderWorkflowList();
        }

        // å…¨éƒ¨å–æ¶ˆæ¿€æ´»
        function deactivateAllWorkflows() {
            workflows.forEach(wf => wf.active = false);
            activeWorkflowId = null;
            saveWorkflows();
            renderWorkflowList();
        }

        // åˆ é™¤å·¥ä½œæµ
        function deleteWorkflow(id) {
            if (workflows.length === 1) {
                alert('è‡³å°‘éœ€è¦ä¿ç•™ä¸€ä¸ªå·¥ä½œæµï¼');
                return;
            }
            
            if (!confirm('ç¡®å®šè¦åˆ é™¤æ­¤å·¥ä½œæµå—ï¼Ÿ')) {
                return;
            }
            
            const index = workflows.findIndex(wf => wf.id === id);
            if (index === -1) return;
            
            workflows.splice(index, 1);
            
            // æ›´æ–° activeWorkflowIdï¼ˆä¿æŒç¬¬ä¸€ä¸ªæ¿€æ´»çš„å·¥ä½œæµIDï¼‰
            const firstActive = workflows.find(wf => wf.active);
            activeWorkflowId = firstActive ? firstActive.id : null;
            
            saveWorkflows();
            renderWorkflowList();
        }

        function buildWorkflowSteps(platformDisplay) {
            const inputTypeLabel = inputTypeDictionary[workflowConfig.app.inputType] || workflowConfig.app.inputType;
            const labels = Object.values(workflowConfig.algo.labelMap).join(' / ');

            return [
                {
                    icon: 'ğŸ“¥',
                    title: 'æ•°æ®è¾“å…¥',
                    description: `ä» ${workflowConfig.app.input} ç›®å½•è·å–å›¾ç‰‡æˆ–æµå¼æ•°æ®ï¼Œæ”¯æŒæ— é™å¾ªç¯è¯»å–ã€‚`,
                    tags: [`è¾“å…¥ç±»å‹: ${inputTypeLabel}`, `å¾ªç¯è¯»å–: ${workflowConfig.app.infinite ? 'æ˜¯' : 'å¦'}`, `å¹³å°: ${platformDisplay}`]
                },
                {
                    icon: 'ğŸ§¹',
                    title: 'é¢„å¤„ç†',
                    description: 'æŒ‰ç…§ç®—æ³•é¢„è®¾æ‰§è¡Œç¼©æ”¾ã€è‰²å½©åŠå½’ä¸€åŒ–ç­‰é¢„å¤„ç†ï¼Œä¿éšœæ¨¡å‹è¾“å…¥ä¸€è‡´æ€§ã€‚',
                    tags: [`æ¨¡å‹ç›®å½•: ${workflowConfig.app.modelDir}`, `å¤šæ ‡ç­¾: ${workflowConfig.algo.multiLabel ? 'å¼€å¯' : 'å…³é—­'}`]
                },
                {
                    icon: 'ğŸ§ ',
                    title: 'æ¨¡å‹æ¨ç†',
                    description: `åŠ è½½ ${workflowConfig.algo.modelName} æ¨¡å‹ï¼Œæ‰§è¡Œ ${workflowConfig.app.type} æ¨ç†ä»»åŠ¡ã€‚`,
                    tags: [`ç½®ä¿¡åº¦: ${workflowConfig.algo.confidence}`, `NMS: ${workflowConfig.algo.nms}`, `æ¨ç†é¢‘ç‡: ${workflowConfig.app.inferFrequency}fps`]
                },
                {
                    icon: 'ğŸ¨',
                    title: 'ç»“æœæ¸²æŸ“',
                    description: 'æ ¹æ®æ ‡ç­¾æ˜ å°„ç»˜åˆ¶æ£€æµ‹æ¡†åŠå±æ€§ä¿¡æ¯ï¼Œè¾“å‡ºå¯è§†åŒ–ç»“æœã€‚',
                    tags: [`OSD: ${workflowConfig.algo.osd ? 'å¼€å¯' : 'å…³é—­'}`, `æ ‡ç­¾: ${labels}`]
                },
                {
                    icon: 'ğŸ“¤',
                    title: 'ç»“æœè¾“å‡º',
                    description: `å°†æ¨ç†ç»“æœè¾“å‡ºè‡³ ${workflowConfig.app.out}ï¼Œå¯æŒ‰éœ€æ‰©å±•è‡³å®æ—¶æµã€‚`,
                    tags: [`è¾“å‡ºè·¯å¾„: ${workflowConfig.app.out}`, 'æ‰©å±•èƒ½åŠ›: æ–‡ä»¶ / æµåª’ä½“']
                }
            ];
        }

        // å‡æ¨¡å‹æ•°æ®
        let modelsData = [
            { id: 'model_1', name: 'YOLOv8s', type: 'Object Detection', framework: 'PyTorch', version: '8.0.0', size: '22.5 MB', accuracy: 'mAP50: 44.9%', status: 'active', lastUpdate: '2025-11-15' },
            { id: 'model_2', name: 'YOLOv5s', type: 'Object Detection', framework: 'PyTorch', version: '7.0', size: '14.1 MB', accuracy: 'mAP50: 37.4%', status: 'active', lastUpdate: '2025-11-10' },
            { id: 'model_3', name: 'RetinaFace', type: 'Face Detection', framework: 'MXNet', version: '1.0', size: '27.3 MB', accuracy: 'AP: 96.5%', status: 'active', lastUpdate: '2025-11-08' }
        ];

        // æµæ°´çº¿æ¨¡å¼
        const pipelineModesData = [
            { id: 'task-parallel', icon: 'âš¡', title: 'ä»»åŠ¡å¹¶è¡Œ', description: 'åŒæ—¶å¤„ç†å¤šä¸ªç‹¬ç«‹ä»»åŠ¡ï¼Œé€‚åˆæ‰¹é‡åœºæ™¯' },
            { id: 'pipeline-parallel', icon: 'ğŸ”', title: 'æµæ°´çº¿å¹¶è¡Œ', description: 'é˜¶æ®µå¹¶è¡Œï¼Œæé«˜ååé‡' },
            { id: 'data-parallel', icon: 'ğŸ“Š', title: 'æ•°æ®å¹¶è¡Œ', description: 'è¾“å…¥æ‹†åˆ†å¹¶è¡Œå¤„ç†' },
            { id: 'no-parallel', icon: 'ğŸ“Œ', title: 'ä¸ä½¿ç”¨å¹¶è¡Œ', description: 'ä¸²è¡Œæ‰§è¡Œï¼Œä¾¿äºè°ƒè¯•' }
        ];

        function renderModels() {
            const grid = document.getElementById('modelGrid');
            if (!grid) return;
            
            if (modelsData.length === 0) {
                grid.innerHTML = '<p style="text-align:center; color:#7f8c8d; padding:40px;">æš‚æ— æ¨¡å‹ï¼Œç‚¹å‡»"æ–°å¢æ¨¡å‹"å¼€å§‹æ·»åŠ ã€‚</p>';
                return;
            }
            
            grid.innerHTML = modelsData.map(m => `
                <div class="model-card">
                    <div class="model-header">
                        <div class="model-name">${m.name}</div>
                        <div class="model-status ${m.status === 'active' ? 'status-active' : 'status-inactive'}">${m.status === 'active' ? 'âœ… è¿è¡Œä¸­' : 'â¸ï¸ å·²åœæ­¢'}</div>
                    </div>
                    <div style="color:#7f8c8d; font-size:13px; margin-bottom:12px;">
                        <div><strong>ç±»å‹:</strong> ${m.type}</div>
                        <div><strong>æ¡†æ¶:</strong> ${m.framework}</div>
                        <div><strong>ç‰ˆæœ¬:</strong> ${m.version}</div>
                        <div><strong>å¤§å°:</strong> ${m.size}</div>
                        <div><strong>ç²¾åº¦:</strong> ${m.accuracy}</div>
                        <div><strong>æ›´æ–°:</strong> ${m.lastUpdate}</div>
                    </div>
                    <div style="display:flex; gap:8px; margin-top:8px;">
                        <button class="workflow-action-btn ${m.status === 'active' ? 'deactivate' : 'activate'}" 
                                onclick="toggleModelStatus('${m.id}')" 
                                style="flex:1; padding:6px 12px;">
                            ${m.status === 'active' ? 'â¸ï¸ åœæ­¢' : 'â–¶ï¸ å¯åŠ¨'}
                        </button>
                        <button class="workflow-action-btn edit" 
                                onclick="configureModel('${m.id}')" 
                                style="flex:1; padding:6px 12px;">
                            âš™ï¸ é…ç½®
                        </button>
                        <button class="workflow-action-btn delete" 
                                onclick="deleteModel('${m.id}')" 
                                style="padding:6px 12px;">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // æ¨¡å‹ç®¡ç†æ“ä½œå‡½æ•°
        function addNewModel() {
            const modelName = prompt('è¯·è¾“å…¥æ¨¡å‹åç§°:', 'NewModel');
            if (!modelName || !modelName.trim()) return;
            
            const modelType = prompt('è¯·è¾“å…¥æ¨¡å‹ç±»å‹ (ä¾‹å¦‚: Object Detection, Face Detection):', 'Object Detection');
            const framework = prompt('è¯·è¾“å…¥æ¨¡å‹æ¡†æ¶ (ä¾‹å¦‚: PyTorch, TensorFlow):', 'PyTorch');
            const version = prompt('è¯·è¾“å…¥æ¨¡å‹ç‰ˆæœ¬:', '1.0.0');
            
            const newModel = {
                id: 'model_' + Date.now(),
                name: modelName.trim(),
                type: modelType || 'Object Detection',
                framework: framework || 'PyTorch',
                version: version || '1.0.0',
                size: '0 MB',
                accuracy: 'N/A',
                status: 'inactive',
                lastUpdate: new Date().toISOString().slice(0, 10)
            };
            
            modelsData.push(newModel);
            saveModels();
            renderModels();
            alert('æ¨¡å‹æ·»åŠ æˆåŠŸï¼');
        }

        function toggleModelStatus(modelId) {
            const model = modelsData.find(m => m.id === modelId);
            if (!model) return;
            
            model.status = model.status === 'active' ? 'inactive' : 'active';
            saveModels();
            renderModels();
        }

        function configureModel(modelId) {
            const model = modelsData.find(m => m.id === modelId);
            if (!model) return;
            
            const newSize = prompt(`é…ç½®æ¨¡å‹å¤§å° (å½“å‰: ${model.size}):`, model.size);
            if (newSize) model.size = newSize;
            
            const newAccuracy = prompt(`é…ç½®æ¨¡å‹ç²¾åº¦ (å½“å‰: ${model.accuracy}):`, model.accuracy);
            if (newAccuracy) model.accuracy = newAccuracy;
            
            const newVersion = prompt(`é…ç½®æ¨¡å‹ç‰ˆæœ¬ (å½“å‰: ${model.version}):`, model.version);
            if (newVersion) model.version = newVersion;
            
            model.lastUpdate = new Date().toISOString().slice(0, 10);
            
            saveModels();
            renderModels();
            alert('æ¨¡å‹é…ç½®å·²æ›´æ–°ï¼');
        }

        function deleteModel(modelId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤æ­¤æ¨¡å‹å—ï¼Ÿ')) return;
            
            const index = modelsData.findIndex(m => m.id === modelId);
            if (index === -1) return;
            
            modelsData.splice(index, 1);
            saveModels();
            renderModels();
        }

        function refreshModels() {
            renderModels();
        }

        function saveModels() {
            try {
                localStorage.setItem('nndeploy_models', JSON.stringify(modelsData));
            } catch (error) {
                console.error('ä¿å­˜æ¨¡å‹æ•°æ®å¤±è´¥:', error);
            }
        }

        function loadModels() {
            try {
                const saved = localStorage.getItem('nndeploy_models');
                if (saved) {
                    modelsData = JSON.parse(saved);
                }
            } catch (error) {
                console.error('åŠ è½½æ¨¡å‹æ•°æ®å¤±è´¥:', error);
            }
        }

        function renderPipelineOptions() {
            const c = document.getElementById('pipelineOptions');
            c.innerHTML = pipelineModesData.map((p, i) => `
                <div class="pipeline-option ${i===0? 'selected':''}" onclick="selectPipeline(this)">
                    <div class="pipeline-icon">${p.icon}</div>
                    <div style="font-weight:600;">${p.title}</div>
                    <div style="color:#7f8c8d; font-size:13px; margin-top:8px;">${p.description}</div>
                </div>
            `).join('');
        }

        function selectPipeline(el) { document.querySelectorAll('.pipeline-option').forEach(x=>x.classList.remove('selected')); el.classList.add('selected'); }

        // å·¥ä½œæµé…ç½®ç¼–è¾‘åŠŸèƒ½
        function openConfigModal(workflowId) {
            currentWorkflowId = workflowId || activeWorkflowId;
            const workflow = getWorkflowById(currentWorkflowId);
            if (!workflow) {
                alert('å·¥ä½œæµä¸å­˜åœ¨');
                return;
            }
            
            const config = workflow.config;
            
            // è®¾ç½®å·¥ä½œæµåç§°
            document.getElementById('config-workflow-name').value = workflow.name;
            
            // å¡«å……å½“å‰é…ç½®åˆ°è¡¨å•
            document.getElementById('config-platform').value = config.platform.current;
            document.getElementById('config-modelName').value = config.algo.modelName;
            document.getElementById('config-confidence').value = config.algo.confidence;
            document.getElementById('config-nms').value = config.algo.nms;
            document.getElementById('config-multiLabel').value = config.algo.multiLabel.toString();
            document.getElementById('config-osd').value = config.algo.osd.toString();
            
            // æ ‡ç­¾æ˜ å°„è½¬æ¢ä¸ºå­—ç¬¦ä¸²
            const labelMapStr = Object.entries(config.algo.labelMap)
                .map(([key, value]) => `${key}:${value}`)
                .join(',');
            document.getElementById('config-labelMap').value = labelMapStr;
            
            document.getElementById('config-modelDir').value = config.app.modelDir;
            document.getElementById('config-inputType').value = config.app.inputType;
            document.getElementById('config-infinite').value = config.app.infinite.toString();
            document.getElementById('config-input').value = config.app.input;
            document.getElementById('config-output').value = config.app.out;
            document.getElementById('config-inferFrequency').value = config.app.inferFrequency;
            document.getElementById('config-appType').value = config.app.type;
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            document.getElementById('configModal').classList.add('show');
        }

        function closeConfigModal() {
            document.getElementById('configModal').classList.remove('show');
        }

        function saveConfig() {
            try {
                if (!currentWorkflowId) {
                    alert('æ²¡æœ‰é€‰ä¸­çš„å·¥ä½œæµ');
                    return;
                }
                
                const workflow = getWorkflowById(currentWorkflowId);
                if (!workflow) {
                    alert('å·¥ä½œæµä¸å­˜åœ¨');
                    return;
                }
                
                // éªŒè¯å·¥ä½œæµåç§°
                const workflowName = document.getElementById('config-workflow-name').value.trim();
                if (!workflowName) {
                    alert('è¯·è¾“å…¥å·¥ä½œæµåç§°');
                    return;
                }
                
                // éªŒè¯å¿…å¡«å­—æ®µ
                const modelName = document.getElementById('config-modelName').value.trim();
                if (!modelName) {
                    alert('è¯·è¾“å…¥æ¨¡å‹åç§°');
                    return;
                }
                
                const confidence = parseFloat(document.getElementById('config-confidence').value);
                if (isNaN(confidence) || confidence < 0 || confidence > 1) {
                    alert('ç½®ä¿¡åº¦å¿…é¡»åœ¨ 0-1 ä¹‹é—´');
                    return;
                }
                
                const nms = parseFloat(document.getElementById('config-nms').value);
                if (isNaN(nms) || nms < 0 || nms > 1) {
                    alert('NMS é˜ˆå€¼å¿…é¡»åœ¨ 0-1 ä¹‹é—´');
                    return;
                }
                
                const inferFreq = parseInt(document.getElementById('config-inferFrequency').value);
                if (isNaN(inferFreq) || inferFreq < 1 || inferFreq > 120) {
                    alert('æ¨ç†é¢‘ç‡å¿…é¡»åœ¨ 1-120 fps ä¹‹é—´');
                    return;
                }
                
                // æ›´æ–°å·¥ä½œæµåç§°
                workflow.name = workflowName;
                
                // è¯»å–è¡¨å•æ•°æ®å¹¶æ›´æ–°å·¥ä½œæµé…ç½®
                workflow.config.platform.current = document.getElementById('config-platform').value;
                workflow.config.algo.modelName = modelName;
                workflow.config.algo.confidence = confidence;
                workflow.config.algo.nms = nms;
                workflow.config.algo.multiLabel = document.getElementById('config-multiLabel').value === 'true';
                workflow.config.algo.osd = document.getElementById('config-osd').value === 'true';
                
                // è§£ææ ‡ç­¾æ˜ å°„
                const labelMapStr = document.getElementById('config-labelMap').value.trim();
                const newLabelMap = {};
                if (labelMapStr) {
                    const items = labelMapStr.split(',');
                    for (let item of items) {
                        const parts = item.split(':');
                        if (parts.length === 2) {
                            const key = parts[0].trim();
                            const value = parts[1].trim();
                            if (key && value) {
                                newLabelMap[key] = value;
                            }
                        }
                    }
                    if (Object.keys(newLabelMap).length === 0) {
                        alert('æ ‡ç­¾æ˜ å°„æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·ä½¿ç”¨æ ¼å¼ï¼š0:äºº,56:æ¡Œå­');
                        return;
                    }
                }
                workflow.config.algo.labelMap = newLabelMap;
                
                workflow.config.app.modelDir = document.getElementById('config-modelDir').value.trim();
                workflow.config.app.inputType = document.getElementById('config-inputType').value;
                workflow.config.app.infinite = document.getElementById('config-infinite').value === 'true';
                workflow.config.app.input = document.getElementById('config-input').value.trim();
                workflow.config.app.out = document.getElementById('config-output').value.trim();
                workflow.config.app.inferFrequency = inferFreq;
                workflow.config.app.type = document.getElementById('config-appType').value;
                
                // ä¿å­˜åˆ° localStorage
                saveWorkflows();
                
                // åˆ·æ–°å·¥ä½œæµåˆ—è¡¨
                renderWorkflowList();
                
                // å…³é—­æ¨¡æ€æ¡†
                closeConfigModal();
                
                // æç¤ºä¿å­˜æˆåŠŸ
                alert('é…ç½®å·²æ›´æ–°å¹¶ä¿å­˜ï¼');
            } catch (error) {
                alert('é…ç½®ä¿å­˜å¤±è´¥ï¼š' + error.message);
            }
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('configModal');
            if (e.target === modal) {
                closeConfigModal();
            }
        });

        // é‡ç½®ä¸ºé»˜è®¤é…ç½®
        function resetConfigToDefault() {
            if (!currentWorkflowId) {
                alert('æ²¡æœ‰é€‰ä¸­çš„å·¥ä½œæµ');
                return;
            }
            
            const workflow = getWorkflowById(currentWorkflowId);
            if (!workflow) {
                alert('å·¥ä½œæµä¸å­˜åœ¨');
                return;
            }
            
            if (confirm('ç¡®å®šè¦é‡ç½®å½“å‰å·¥ä½œæµä¸ºé»˜è®¤é…ç½®å—ï¼Ÿ')) {
                // æ¢å¤é»˜è®¤é…ç½®
                workflow.config = JSON.parse(JSON.stringify(defaultWorkflowTemplate));
                
                // ä¿å­˜åˆ° localStorage
                saveWorkflows();
                
                // åˆ·æ–°å·¥ä½œæµåˆ—è¡¨
                renderWorkflowList();
                
                // å…³é—­æ¨¡æ€æ¡†
                closeConfigModal();
                
                alert('å·²é‡ç½®ä¸ºé»˜è®¤é…ç½®ï¼');
            }
        }

        // å¯¼å‡ºé…ç½®ä¸º JSON æ–‡ä»¶
        // å¯¼å‡ºæ‰€æœ‰å·¥ä½œæµé…ç½®
        function exportAllWorkflows() {
            try {
                const configJson = JSON.stringify(workflows, null, 2);
                const blob = new Blob([configJson], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `workflows_config_${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                alert('å·¥ä½œæµé…ç½®å·²å¯¼å‡º');
            } catch (error) {
                alert('å¯¼å‡ºé…ç½®å¤±è´¥ï¼š' + error.message);
            }
        }
        
        // å¯¼å‡ºå•ä¸ªå·¥ä½œæµï¼ˆå…¼å®¹æ—§ç‰ˆæœ¬ï¼‰
        function exportConfig() {
            const workflow = getActiveWorkflow();
            if (!workflow) {
                alert('æ²¡æœ‰æ¿€æ´»çš„å·¥ä½œæµ');
                return;
            }
            
            try {
                const configJson = JSON.stringify(workflow.config, null, 2);
                const blob = new Blob([configJson], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `workflow_${workflow.name}_${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                alert('å·¥ä½œæµé…ç½®å·²å¯¼å‡º');
            } catch (error) {
                alert('å¯¼å‡ºé…ç½®å¤±è´¥ï¼š' + error.message);
            }
        }

        // å¯¼å…¥å·¥ä½œæµé…ç½®ä» JSON æ–‡ä»¶
        function importConfig(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    
                    // åˆ¤æ–­æ˜¯å¯¼å…¥å•ä¸ªå·¥ä½œæµé…ç½®è¿˜æ˜¯å¤šä¸ªå·¥ä½œæµ
                    if (Array.isArray(imported)) {
                        // å¯¼å…¥å¤šä¸ªå·¥ä½œæµ
                        if (imported.length === 0) {
                            throw new Error('å·¥ä½œæµé…ç½®ä¸ºç©º');
                        }
                        
                        // éªŒè¯æ¯ä¸ªå·¥ä½œæµçš„ç»“æ„
                        for (let wf of imported) {
                            if (!wf.id || !wf.name || !wf.config) {
                                throw new Error('å·¥ä½œæµæ ¼å¼ä¸æ­£ç¡®');
                            }
                            if (!wf.config.platform || !wf.config.algo || !wf.config.app) {
                                throw new Error('å·¥ä½œæµé…ç½®æ ¼å¼ä¸æ­£ç¡®');
                            }
                        }
                        
                        // æ›¿æ¢æ‰€æœ‰å·¥ä½œæµ
                        workflows = imported;
                        
                        // ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªæ¿€æ´»çš„å·¥ä½œæµ
                        const hasActive = workflows.some(wf => wf.active);
                        if (!hasActive && workflows.length > 0) {
                            workflows[0].active = true;
                        }
                        
                        // æ›´æ–° activeWorkflowId
                        const activeWf = workflows.find(wf => wf.active);
                        activeWorkflowId = activeWf ? activeWf.id : null;
                        
                    } else if (imported.platform && imported.algo && imported.app) {
                        // å¯¼å…¥å•ä¸ªå·¥ä½œæµé…ç½®ï¼ˆæ—§æ ¼å¼ï¼‰
                        const newWorkflow = {
                            id: 'wf_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                            name: 'å¯¼å…¥çš„å·¥ä½œæµ',
                            active: false,
                            config: imported
                        };
                        
                        workflows.push(newWorkflow);
                        
                    } else {
                        throw new Error('é…ç½®æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®');
                    }
                    
                    // ä¿å­˜åˆ° localStorage
                    saveWorkflows();
                    
                    // é‡æ–°æ¸²æŸ“
                    renderWorkflowList();
                    
                    alert('é…ç½®å¯¼å…¥æˆåŠŸï¼');
                } catch (error) {
                    alert('å¯¼å…¥é…ç½®å¤±è´¥ï¼š' + error.message);
                }
            };
            reader.readAsText(file);
            
            // é‡ç½® inputï¼Œå…è®¸é‡å¤å¯¼å…¥åŒä¸€æ–‡ä»¶
            event.target.value = '';
        }

        function renderWorkflowSummary() {
            const summaryEl = document.getElementById('workflowSummary');
            if (!summaryEl) return;

            const workflow = getActiveWorkflow();
            if (!workflow) {
                summaryEl.innerHTML = '<div style="padding:20px; text-align:center; color:#999;">æš‚æ— æ¿€æ´»çš„å·¥ä½œæµ</div>';
                return;
            }

            const config = workflow.config;
            const platformDisplay = config.platform.current.charAt(0).toUpperCase() + config.platform.current.slice(1);
            const supportedPlatforms = config.platform.supported.map(item => item.toUpperCase());
            const inputTypeLabel = inputTypeDictionary[config.app.inputType] || config.app.inputType;

            const summaryCards = [
                { icon: 'ğŸ“‹', title: 'å·¥ä½œæµåç§°', value: workflow.name, subtitle: workflow.active ? 'âœ… å½“å‰æ¿€æ´»' : '' },
                { icon: 'ğŸ§©', title: 'éƒ¨ç½²å¹³å°', value: platformDisplay, subtitle: `æ”¯æŒï¼š${supportedPlatforms.join(' | ')}` },
                { icon: 'ğŸ§ ', title: 'æ¨¡å‹é…ç½®', value: config.algo.modelName, subtitle: `ç½®ä¿¡åº¦ ${config.algo.confidence} Â· NMS ${config.algo.nms}` },
                { icon: 'ğŸ”', title: 'ä¸šåŠ¡æµ', value: `${config.app.input} â†’ ${config.app.out}`, subtitle: `${inputTypeLabel} Â· ${config.app.inferFrequency}fps` }
            ];

            summaryEl.innerHTML = summaryCards.map(card => `
                <div class="workflow-summary-card">
                    <div class="card-icon">${card.icon}</div>
                    <div class="card-title">${card.title}</div>
                    <div class="card-value">${card.value}</div>
                    <div class="card-subtitle">${card.subtitle}</div>
                </div>
            `).join('');
        }

        function renderWorkflow() {
            const summaryEl = document.getElementById('workflowSummary');
            const diagramEl = document.getElementById('workflowDiagram');
            const detailsEl = document.getElementById('workflowDetails');
            if (!summaryEl || !diagramEl || !detailsEl) return;

            const workflow = getActiveWorkflow();
            if (!workflow) {
                summaryEl.innerHTML = '<div style="padding:20px; text-align:center; color:#999;">æš‚æ— æ¿€æ´»çš„å·¥ä½œæµ</div>';
                diagramEl.innerHTML = '';
                detailsEl.innerHTML = '';
                return;
            }

            const workflowConfig = workflow.config;
            const platformDisplay = workflowConfig.platform.current.charAt(0).toUpperCase() + workflowConfig.platform.current.slice(1);
            const supportedPlatforms = workflowConfig.platform.supported.map(item => item.toUpperCase());
            const inputTypeLabel = inputTypeDictionary[workflowConfig.app.inputType] || workflowConfig.app.inputType;
            const labelSummary = Object.entries(workflowConfig.algo.labelMap).map(([code, label]) => `${code}: ${label}`).join('ï¼Œ');

            const summaryCards = [
                { icon: 'ğŸ“‹', title: 'å·¥ä½œæµåç§°', value: workflow.name, subtitle: workflow.active ? 'âœ… å½“å‰æ¿€æ´»' : '' },
                { icon: 'ğŸ§©', title: 'éƒ¨ç½²å¹³å°', value: platformDisplay, subtitle: `æ”¯æŒï¼š${supportedPlatforms.join(' | ')}` },
                { icon: 'ğŸ§ ', title: 'æ¨¡å‹é…ç½®', value: workflowConfig.algo.modelName, subtitle: `ç½®ä¿¡åº¦ ${workflowConfig.algo.confidence} Â· NMS ${workflowConfig.algo.nms}` },
                { icon: 'ğŸ“¦', title: 'æ¨¡å‹ç›®å½•', value: workflowConfig.app.modelDir, subtitle: `å¤šæ ‡ç­¾ï¼š${workflowConfig.algo.multiLabel ? 'å¼€å¯' : 'å…³é—­'} Â· OSDï¼š${workflowConfig.algo.osd ? 'å¼€å¯' : 'å…³é—­'}` },
                { icon: 'ğŸ”', title: 'ä¸šåŠ¡æµ', value: `${workflowConfig.app.input} â†’ ${workflowConfig.app.out}`, subtitle: `è¾“å…¥ç±»å‹ï¼š${inputTypeLabel} Â· æ¨ç†é¢‘ç‡ï¼š${workflowConfig.app.inferFrequency}fps` }
            ];

            summaryEl.innerHTML = summaryCards.map(card => `
                <div class="workflow-summary-card">
                    <div class="card-icon">${card.icon}</div>
                    <div class="card-title">${card.title}</div>
                    <div class="card-value">${card.value}</div>
                    <div class="card-subtitle">${card.subtitle}</div>
                </div>
            `).join('');

            const steps = buildWorkflowSteps(platformDisplay);

            diagramEl.innerHTML = steps.map(step => `
                <div class="workflow-step">
                    <div class="workflow-icon">${step.icon}</div>
                    <h4>${step.title}</h4>
                    <p>${step.description}</p>
                    <div class="workflow-tags">
                        ${step.tags.map(tag => `<span class="workflow-tag">${tag}</span>`).join('')}
                    </div>
                </div>
            `).join('');

            const detailSections = [
                {
                    title: 'å¹³å°é…ç½®',
                    items: [
                        { label: 'è¿è¡Œå¹³å°', value: platformDisplay },
                        { label: 'æ”¯æŒå¹³å°', value: supportedPlatforms.join(' / ') }
                    ]
                },
                {
                    title: 'ç®—æ³•å‚æ•°',
                    items: [
                        { label: 'æ¨¡å‹åç§°', value: workflowConfig.algo.modelName },
                        { label: 'ç½®ä¿¡åº¦é˜ˆå€¼', value: workflowConfig.algo.confidence },
                        { label: 'NMS é˜ˆå€¼', value: workflowConfig.algo.nms },
                        { label: 'å¤šæ ‡ç­¾', value: workflowConfig.algo.multiLabel ? 'å¼€å¯' : 'å…³é—­' },
                        { label: 'OSD æ¸²æŸ“', value: workflowConfig.algo.osd ? 'å¼€å¯' : 'å…³é—­' },
                        { label: 'æ ‡ç­¾æ˜ å°„', value: labelSummary }
                    ]
                },
                {
                    title: 'åº”ç”¨è¾“å…¥/è¾“å‡º',
                    items: [
                        { label: 'è¾“å…¥ç±»å‹', value: inputTypeLabel },
                        { label: 'è¾“å…¥è·¯å¾„', value: workflowConfig.app.input },
                        { label: 'æ— é™å¾ªç¯', value: workflowConfig.app.infinite ? 'æ˜¯' : 'å¦' },
                        { label: 'è¾“å‡ºè·¯å¾„', value: workflowConfig.app.out },
                        { label: 'æ¨ç†é¢‘ç‡', value: `${workflowConfig.app.inferFrequency} FPS` },
                        { label: 'åº”ç”¨ç±»å‹', value: workflowConfig.app.type }
                    ]
                },
                {
                    title: 'æœåŠ¡ä¸æ‰©å±•',
                    items: [
                        { label: 'æ¸²æŸ“è¾“å‡º (OSD)', value: workflowConfig.app.osd ? 'å¯ç”¨' : 'å…³é—­' },
                        { label: 'WebSocket æœåŠ¡', value: workflowConfig.app.service.websocket.port ? `ç«¯å£ ${workflowConfig.app.service.websocket.port}` : 'æœªå¼€å¯' },
                        { label: 'ç”µå­å›´æ ', value: workflowConfig.app.fence ? 'å·²é…ç½®' : 'æœªé…ç½®' }
                    ]
                }
            ];

            detailsEl.innerHTML = detailSections.map(section => `
                <div class="workflow-detail-section">
                    <h4>${section.title}</h4>
                    <div class="workflow-detail-list">
                        ${section.items.map(item => `<div class="workflow-detail-item"><strong>${item.label}ï¼š</strong>${item.value}</div>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        // ç›‘æ§é€»è¾‘ï¼ˆæŠ˜çº¿å›¾ï¼‰
        let monitorCharts = {};
        let monitorIntervals = {};

        function createMonitorCard(id, title, unit) {
            return `
                <div class="monitor-card">
                    <div class="monitor-header"><div class="monitor-title">${title}</div><div id="${id}-value" class="monitor-value">0${unit}</div></div>
                    <div class="chart-container"><canvas id="${id}-chart"></canvas></div>
                </div>
            `;
        }

        function renderMonitor() {
            const grid = document.getElementById('monitorGrid');
            grid.innerHTML = [
                createMonitorCard('cpu','CPU ä½¿ç”¨ç‡','%'),
                createMonitorCard('npu','NPU ä½¿ç”¨ç‡','%'),
                createMonitorCard('memory','å†…å­˜ä½¿ç”¨',' GB'),
                createMonitorCard('gpu','æ˜¾å­˜ä½¿ç”¨',' GB')
            ].join('');
            initMonitorCharts();
        }

        function initMonitorCharts() {
            ['cpu','npu','memory','gpu'].forEach(r=>{
                const canvas = document.getElementById(`${r}-chart`);
                if(!canvas) return;
                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth; canvas.height = canvas.offsetHeight;
                monitorCharts[r] = { ctx, data: new Array(60).fill(0), max: (r==='memory'||r==='gpu')?16:100 };
                startMonitorUpdate(r);
            });
        }

        function startMonitorUpdate(r) {
            monitorIntervals[r] = setInterval(()=>{
                const ch = monitorCharts[r]; if(!ch) return;
                let v = 0;
                if (r==='cpu') v = 20 + Math.random()*60;
                else if (r==='npu') v = 30 + Math.random()*50;
                else if (r==='memory') v = 4 + Math.random()*6;
                else if (r==='gpu') v = 1 + Math.random()*4;
                ch.data.push(v); ch.data.shift();
                const valEl = document.getElementById(`${r}-value`); if(valEl) valEl.textContent = (r==='memory'||r==='gpu')? v.toFixed(2)+' GB' : v.toFixed(1)+'%';
                drawChart(r);
            }, 1000);
        }

        function drawChart(r) {
            const ch = monitorCharts[r]; if(!ch) return; const ctx = ch.ctx; const c = ctx.canvas; const data = ch.data; const max = ch.max;
            ctx.clearRect(0,0,c.width,c.height);
            ctx.strokeStyle = '#e6eef8'; ctx.lineWidth = 1; for(let i=0;i<4;i++){ const y=(c.height/4)*i; ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(c.width,y); ctx.stroke(); }
            ctx.beginPath(); ctx.strokeStyle='#3498db'; ctx.lineWidth=2; data.forEach((v,i)=>{ const x=i*(c.width/(data.length-1)); const y=c.height-(v/max)*c.height; if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y); }); ctx.stroke();
            ctx.lineTo(c.width,c.height); ctx.lineTo(0,c.height); ctx.closePath(); ctx.fillStyle='rgba(52,152,219,0.08)'; ctx.fill();
        }

        function stopMonitor() { Object.keys(monitorIntervals).forEach(k=>clearInterval(monitorIntervals[k])); monitorIntervals={}; }

        // æ—¥å¿—
        function generateLogs() {
            const levels = [ ['info','INFO','log-level-info'], ['success','SUCCESS','log-level-success'], ['warn','WARN','log-level-warn'], ['error','ERROR','log-level-error'] ];
            const msgs = ['NNDeploy å¯åŠ¨æˆåŠŸ','åŠ è½½æ¨¡å‹: YOLOv8s.onnx','TensorRT åˆå§‹åŒ–å®Œæˆ','æ¨ç†ä»»åŠ¡å¼€å§‹','æ£€æµ‹åˆ° 5 ä¸ªç›®æ ‡','æ¨ç†è€—æ—¶: 9.3ms','NPU åˆ†é…æˆåŠŸ','é¢„å¤„ç†å®Œæˆ','åå¤„ç†å®Œæˆ','å·¥ä½œæµé…ç½®å·²ä¿å­˜'];
            const now = new Date(); let out=''; for(let i=0;i<120;i++){ const t=new Date(now - i*2000); const lvl=levels[Math.floor(Math.random()*levels.length)]; const m=msgs[Math.floor(Math.random()*msgs.length)]; out = `<div class="log-entry"><span class="log-time">[${t.toLocaleTimeString('zh-CN',{hour12:false})}]</span> <span class="${lvl[2]}">[${lvl[1]}]</span> ${m}</div>` + out; }
            return out;
        }

        function renderLogs(){ document.getElementById('logContainer').innerHTML = generateLogs(); const c=document.getElementById('logContainer'); c.scrollTop = c.scrollHeight; }

        // é¡µé¢åˆ‡æ¢é€»è¾‘
        function showPage(name) {
            document.querySelectorAll('.page-container').forEach(p=>p.classList.add('hidden'));
            const el = document.getElementById('page-'+name); if(el) el.classList.remove('hidden');
            // ç›‘æ§é¡µé¢è¦å¯åŠ¨æ›´æ–°
            if(name==='monitor') { setTimeout(()=>{ renderMonitor(); }, 120); } else { stopMonitor(); }
            if(name==='workflow') { 
                renderWorkflowList(); 
            }
            // è®¾ç½®æ ‡é¢˜å’Œèœå•æ¿€æ´»
            const link = document.querySelector(`.menu-link[data-page="${name}"]`);
            if(link) {
                document.getElementById('page-title').textContent = link.dataset.title || link.textContent.trim();
                document.querySelectorAll('.menu-link').forEach(l=>l.classList.remove('active'));
                link.classList.add('active');
            }
        }

        // è·¯ç”±å¤„ç†
        window.addEventListener('hashchange', ()=>{
            const h = window.location.hash || '#/';
            if(h === '#/workflow') showPage('workflow');
            else if(h === '#/models') showPage('models');
            else if(h === '#/pipeline') showPage('pipeline');
            else if(h === '#/monitor') showPage('monitor');
            else if(h === '#/logs') showPage('logs');
            else showPage('dashboard');
        });

        // æ‹¦æˆªå†…éƒ¨èœå•ç‚¹å‡»ï¼Œä½¿ç”¨ SPA åˆ‡æ¢
        document.addEventListener('click', function(e){ 
            const a = e.target.closest('.menu-link'); 
            if(!a) return; 
            e.preventDefault();
            const targetHash = a.getAttribute('href');
            window.location.hash = targetHash;
        });

        // åº”ç”¨åˆå§‹åŒ–å‡½æ•°
        function initApp() {
            // åŠ è½½ä¿å­˜çš„å·¥ä½œæµé…ç½®
            loadWorkflows();
            // åŠ è½½ä¿å­˜çš„æ¨¡å‹æ•°æ®
            loadModels();
            
            renderModels();
            renderPipelineOptions();
            renderLogs();
            renderWorkflowList();

            const reactContainer = document.getElementById('react-app-container');
            const customDashboard = document.getElementById('custom-dashboard');
            if (reactContainer) reactContainer.style.display = 'none';
            if (customDashboard) customDashboard.style.display = 'block';

            const h = window.location.hash || '#/';
            if(h === '#/workflow') showPage('workflow');
            else if(h === '#/models') showPage('models');
            else if(h === '#/pipeline') showPage('pipeline');
            else if(h === '#/monitor') showPage('monitor');
            else if(h === '#/logs') showPage('logs');
            else showPage('dashboard');
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
        window.addEventListener('load', ()=>{
            checkLoginStatus();
        });
    </script>
</body>
</html>
